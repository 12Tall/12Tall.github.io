---
title: 控制系统基本概念
sidebar: auto  
tags:  
    - 拉式变换  
    - 传递函数  
    - 梅森  
    - 线性  
    - 定常  
    - 微分方程  
---
# 经典控制系统
经典的控制系统一般可分为：开环控制、闭环控制、复合控制三大类  

对于经典控制系统，一般要求：稳定、准确、快速  

对于经典控制系统的分析与校正，一般分为：时域法、复域法、频域法  
$$Model \xrightleftarrows[Adjust]{Analyze} Performance$$    

## 经典控制系统的数学模型  
时域数学模型  --  微分方程  
复域数学模型  --  传递函数  
- 解析法：白盒子，了解系统的工作机制根据物理定律列写方程  
- 实验法：黑盒子，给系统施加某种测试信号，记录输出相应，并用适当的数学模型逼近系统的输入输出特性  

经典控制理论主要研究线性定常系统，其它系统不好解决。  
输入$r(t)$ --> [系统] --> 输出$c(t)$   
$$a_n \frac{d^n c(t)}{dt^n} + a_{n-1} \frac{d^{n-1} c(t)}{dt^{n-1}} + ... + a_{1} \frac{d c(t)}{dt} + a_{0} c(t) = b_m \frac{d^m r(t)}{dt^m} + b_{m-1} \frac{d^{m-1} r(t)}{dt^{m-1}} + ... + b_{1} \frac{d r(t)}{dt} + b_{0} r(t)$$  
- 线性看变量阶数，这里的变量是输入输出函数，注意线性系统只能是一阶  
- 定常看系数是否为常数  

## 时域法  

::: details 例 RLC 串联电路  
```
-----L-----R---+----
               |
Ur             C   Uc
               |
---------------+----
```  

$$U_r(t) = L \frac{di(t)}{dt} + Ri(t) + U_c(t) \tag{1}$$  
$$i(t) = C \frac{du_c(t)}{dt} \tag{2}$$  
联立两式，即可得到其微分方程。  
:::

感觉对于时域法，最难的是列系统的微分方程。但是系统的物理方程对于研究自动控制理论似乎并不重要。  

::: details 直流电机  
电枢回路，基尔霍夫电压定律  
$$U_r = Ri + E_b \tag{1}$$  

电枢反电动势，楞次定律
$$E_b = c_e \omega_m \tag{2}$$  

电磁力矩，安培定律    
$$M_m = c_m i \tag{3}$$

力矩平衡，牛顿定律(输出力矩+摩擦力矩=电磁力矩)  
$$J_m \omega_m + f_m \omega_m = M_m, \omega_m = \dot{\theta}_m$$

这是电机学里面的重点，同样自控原理里面不重要  
:::  

在误差不大的情况下，可以将非线性的函数局部线性化  

::: details 例 线性化  
已知输入输出特性如下，求$(x_0, y_0)$ 处小扰动线性化方程  
$$y(x) = E_0 \cos{x(t)}$$  

解：在工作点$(x_0, y_0)$ 处泰勒展开  
$$y(x) = y(x_0) + y'(x_0)(x-x_0) + \frac{1}{2!} y''(x_0)(x-x_0)^2 + ... + \frac{1}{n!} y^{(n)}(x_0)(x-x_0)^{n}$$  
:::  

通过求解微分方程就可以得到精确的系统，但是直接解微分方程过于复杂，于是可以通过拉氏变换转换到复域进行计算  

::: details 拉氏变换复习
自动控制系统中的拉斯变换积分区间一般都是$[0, \infty]$  
1. 线性性质  
   $$L[a f_1(t) \plusmn bf_2(t)] = aF_1(s) + bF_2(s)$$
2. 微分定理  
   $$L[f'(t)] = s F(s) - f(0)$$
3. 积分定理  
   $$L[ \int f(t) dt] = \frac{1}{s} F(s) + \frac{1}{s}f^{(-1)}(0)$$
4. 时位移定理  
   $$L[f(t - \tau_0)] = e^{-\tau_0s}F(s)$$
5. 复位移定理，相当于s 位移了  
   $$L[e^{At}f(t)] = F(s-A)$$  
6. 初值定理，求响应的初始值时有用  
   $$\lim\limits_{t \rightarrow 0} f(t) = \lim\limits_{s \rightarrow \infty} s F(s)$$
7. 终值定理，用于计算系统的稳态误差  
   $$\lim\limits_{t \rightarrow \infty} f(t) = \lim\limits_{s \rightarrow 0} s F(s) ds$$  

注意函数与常见基本函数的关系，就可以方便地获取到复杂函数的拉氏变换  
单位阶跃，微分：冲击；积分：斜坡，n 次积分：...；  


## 拉普拉斯反变换  

$$f(t) = \frac{1}{2 \pi j} \int_{\sigma - j\infty}^{\sigma + j\infty} F(s) e^{ts}$$  
但更多的是根据查表，与位移来组合出原函数：试凑法、系数比较法、留数法  
一般常用留数法将拉式相函数拆分为基本的形式，然后查表得出原函数  

例 1： $F(s) = \frac{1}{s(s+a)}, f(t) = ?$  

留数法（常用）：一般地  
$$F(s) = \frac{B(s)}{A(s)} = \frac{b_ms^m + b_{m-1}s^{m-1} + ... + b_0}{a_ns^n + a_{n-1}s^{n-1} + ... + a_0} (n>m)$$  
设：  
$$A(s) = (s-p_1)(s-p_2)...(s-p_n)$$  
- 当$A(s) = 0$ **没有重根**的时候，
$$F(s) = \sum_{i=1}^{n} \frac{C_i}{s-p_i}$$  
$$C_i = \lim\limits_{x \rightarrow p_i} (s - p_i) \frac{B(s)}{A(s)} \tag{留数法}$$  

- 当$A(s) = 0$，假设$p_1 为$**m重根**，则有  
$$F(s) = \frac{C_m}{(s-p_1)^m} + \frac{C_{m-1}}{(s-p_1)^{m-1}} + ...  + \frac{C_{m+1}}{(s-p_{m+1})} + ... + \frac{C_{n}}{(s-p_{n})}$$  
重根两边同时乘以$(s-p_1)^m$，然后两边逐次求导    
$c_m = \lim\limits_{s \rightarrow p_1} (s-p1)^m F(s)$  
$c_{m-j} = \frac{1}{j!} \lim\limits_{s \rightarrow p_1} \frac{d^{(j)}}{ds^{j}} [(s-p1)^m F(s)]$  
$c_1 = \frac{1}{(m-1)!} \lim\limits_{s \rightarrow p_1} \frac{d^{(m-1)}}{ds^{m-1}} [(s-p1)^m F(s)]$

例：已知$F(s) = \frac{s+2}{s (s+1)^2 (s+3)}$，求$f(t) = ?$  
解：注意多重根要降序排列  
$$F(s) = \frac{C_2}{(s+1)^2} + \frac{C_1}{s+1} + \frac{C_3}{s} + \frac{C_4}{s+3}$$  
$$C_2 = \frac{1}{0!} \lim\limits_{s \rightarrow 1} (s+1)^2 F(s)$$
$$C_1 = \frac{1}{1!} \lim\limits_{s \rightarrow 1} \frac{d}{ds} [(s+1)^2 F(s)]$$
:::  

::: details 模态：振型  
模态可以看成是系统单位脉冲响应的最简单形式，一个系统可以看作一系列模态的组合    

$$c^{(4)}(t) + 12c^{(3)}(t) + 21c^{(2)}(t) + 82c^{(1)}(t) + 80c^{(0)}(t) = 80\delta(t)$$  
两边同时进行拉氏变换，得：  
$$(s^4 + 12s^3 + 21s^2 + 82s + 80)C(s) = 80$$  
$$C(s) = \frac{80}{s^4 + 12s^3 + 21s^2 + 82s + 80}$$  
$$= \frac{80}{(s + 2)(s + 8)(s^2 + 2s + 5)}$$  
在代数上，一定可以拆分为下面形式：  
$$\frac{a}{s+2} - \frac{b}{s+8} - \frac{c}{s + 1 + 2j} - \frac{d}{s + 1 - 2j} $$  

可以使用在`Matlab` 中使用`residue` 函数对上式进行展开。[函数简介](https://ww2.mathworks.cn/help/matlab/ref/residue.html)  
```matlab
b = [-4 8];
a = [1 6 8];
[r,p,k] = residue(b,a)  

%{ 输出结果
r =
   -12
     8 
p =
    -4
    -2
k =
     []    
}%

%% 逆变换
[b,a] = residue(r,p,k) 
```

最终形式为$\frac{-12}{s+4} + \frac{8}{s+2}$ 

:::

影响系统响应的因素：输入、初始条件、系统结构参数  

## 复域法  
似乎跟电力系统的暂态分析与稳态分析也有关系啊，不过这些都不重要。。。  

### 传递函数  
在`零初始`条件下，线性定常系统输出量与输入量的拉氏变换之比  
$$G(s) = \frac{C(s)}{R(s)}$$  
一般是一个关于s 的有理分式，怎么来的可以参考[卷积](../math/卷积.md)  
- 首1 标准型：多项式最高项系数值是1  
- 尾1 标准型：多项式最低项（不一定是常数项）系数值是1   
- 增益：对于不同标准型提取出来的公共系数$K$，一般是指尾1 型 

::: details 传递函数的性质：
1. 传递函数是复函数  
2. 传递函数只与系统自身结构参数有关  
3. 传递函数与系统微分方程直接关联  
4. 传递函数与s 平面的上的零极点图相对应  
:::

::: details 传递函数的局限：  
1. 原则上不反应初条件的信息。但是可以通过传递函数得到微分方程，然后再加上初始条件来实现  
2. 适用于单输入单输出系统  
3. 只能用于线性定常系统
:::  

::: details 非零初始分析步骤：
1. 交叉相乘得到微分方程  
2. 根据s 的次数写出拉式变换非零初始状态的标准形式：$(...)C(s) = (...)R(s)$  
3. 代入初始条件  
4. 拉氏反变换，得到最终的响应  
:::  

::: details  阻抗计算  
电阻: $Z(s) = R, Y(s) = \frac{1}{R}$  
电容: $Z(s) = \frac{1}{sC}, Y(s) = sC$   
$$C = \frac{Q}{U_c}$$
$$U_c(t) = \frac{ \int i(t) dt }{C} $$  
$$U_c(s) = \frac{I(s)}{sC}$$  
$$\frac{U_c(s)}{I(s)} = \frac{1}{sC}$$  
电感: $Z(s) = sL, Y(s) = \frac{1}{sL}$  
$$U_l = L \frac{di}{dt}$$
$$U_l(t) = L \frac{ d i(t) }{dt} $$  
$$U_l(s) = sL I(s)$$  
$$\frac{U_l(s)}{I(s)} = sL$$  
:::  

::: details 常用控制元件的传递函数
除反馈环节外，控制元件输入输出之间应该是相互隔离的。也就是说理论上控制信号不参与做功。  
- 电位器：$G(s) = \frac{U(s)}{\Theta(s)} = K$。将位移/角度转化为电压信号  
- 误差角检测器：$G(s) = \frac{U(s)}{\Delta \Theta(s)} = K$。利用电桥将位移/角度差转化为电压信号  
- 自整角机：$G(s) = K$。  
- 直流测速发电机：$G(s) = \frac{U(s)}{\Omega(s)} = K$。  
- 交流测速发电机：$G(s) = \frac{U(s)}{\Omega(s)} = K$。  
- 电枢控制的直流电动机：$G_{\Omega}(s) = \frac{\Omega(s)}{U(s)} = \frac{K_m}{T_ms + 1}, G_{\Theta}(s) = \frac{\Theta(s)}{U(s)} = \frac{K_m}{s(T_ms + 1)}$。角度相当于角速度串联一个积分环节    
- 两相异步电机：$G_{\Omega}(s) = \frac{\Omega(s)}{U(s)} = \frac{K_m}{T_ms + 1}, G_{\Theta}(s) = \frac{\Theta(s)}{U(s)} = \frac{K_m}{s(T_ms + 1)}$
  两个常数都可以测出来  
  - 堵转力矩：$M_s(t) = c_mU_c(t)$  
  - 机械特性：$M_m(t) = M_s(t) - c_{\omega}\omega(t)$  
  - 牛顿定律：$J_m\omega(t) + f_m\omega(t) = M_m(t)$  

可以采取消除中间变量，或者可以对每个方程当作一个子系统进行拉式变换，然后再连接（妙啊）  
  
- 齿轮系：$G(s) = \frac{1}{i}$。i 是传动比。根据转动惯量定义，次级转动惯量折合到上一级要乘以$\frac{1}{i^2}$。  
:::

### 典型传递函数环节  
环节：具有相同形式传递函数的元件的分类。  

::: details  典型环节
1. 比例环节：$G(s) = K$。放大器  
2. 惯性环节：$G(s) = \frac{1}{Ts + 1}$。CR 电路，交、直流电动机  
3. 震荡环节：$G(s) = \frac{1}{T^2s^2 + 2\xi Ts+1}$。RLC 电路，弹簧系统  
4. 积分环节：$G(s) = \frac{1}{s}$。水箱  
5. 微分环节：$G(s) = s$。  
6. 一阶符合微分环节：$G(s) = \tau s + 1$  
7. 二阶复合微分环节：$G(s) = \tau^2 s^2 + 2 \xi s + 1$
8. 延时环节：不太常见，且不是线性环节  

三个微分系统环节物理上未必存在。
注意传递函数的负载效应：也就是之前说的，环节之间应彼此隔离。
:::

**时域 <=> 复域的对应关系**  
时域：原理图 --> 方框图 --> 微分方程组 --> 消去中间变量  --> 系统微分方程  
复域：原理图 --> 方框图 --> 元件传递函数 --> 系统结构图  --结构图化简/Mason 公式--> 系统传递函数  

### 结构图等效化简  
好像把自控的知识用到电机与拖动也挺好用的。。。甚至可以把直流电机分成好几个控制环节    
1. 串联：传递函数直接相乘  
2. 并联：按比较器加或减  
3. 反馈：$\Phi(s) = \frac{G(s)}{1\mp G(s)H(s)}$。注意负反馈是+，正反馈是-  
4. 比较点移动：前移除以前一环节传递函数；后移乘以后一环节传递函数  
5. 引出点移动：前移乘；后移除。与比较点类比
6. 比较点与引出点之间位置互换：注意增减反馈信号

### 梅森增益公式  
信号流图：方框图的进一步简化了线条。信号与系统中常用  
::: details 信号流图概念  
源节点：只有信号流出  
阱节点：只有信号流入  
混合节点：有入有出  
支路：相当于一个方框  
支路增益：就传递函数  
前向通路：从源节点到阱节点的通道，走过的路不能重复  
回路：  
互不接触回路：
:::  
Mason 增益公式：  
$$G(s) = \frac{1}{\Delta} \sum_{k=1}^{n} P_k \Delta_k  \tag{Mason}$$  
1. $\Delta$ 特征式：$\Delta = 1 - \sum L_a + \sum L_bL_c - \sum L_dL_eL_d$  
2. $\sum L_a$ 所有不同回路增益之和  
3. $\sum L_aL_b$ 所有两两互补接触回路增益之积的和  
4. $\sum L_dL_eL_d$ 三三不接触回路的乘积之和  
5. $\Delta_k$ 第k 条前向通道的余子式。把与第k 条前向通路接触的回路全部去除，剩余回路构成的子特征式。递归进入`1`  
6. $P_k$ 前向通路增益之积  

::: details 步骤  
1. 找出所有回路  
2. 写出$\Delta$ 特征值，注意负反馈的回路增益是负的    
3. 找出一个前向通道，求出其总增益  
4. 寻找该前向通道的余子式特征值  
:::

### 开环传递函数  
（输入，干扰） --> （输出，偏差）  
把主反馈（最外圈反馈）打断，前向通道传递函数乘以反馈  
开环增益：开环传递函数的尾1 形式增益  
如果回路结构不发生改变，不管信号从哪里输入，特征式都是一样的  

[课程链接](https://www.bilibili.com/video/BV1ix411r7vg5)